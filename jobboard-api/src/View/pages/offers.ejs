<!DOCTYPE html>
<html lang="fr">
  <head>
    <%- include('../partials/head', { title: 'Offres d‚Äôemploi ‚Äì Ruca JobBoard' }) %>
    <link rel="stylesheet" href="/css/offers.css" />
  </head>

  <body>
    <!-- HEADER -->
    <header>
      <h1>Ruca ‚Äì trouvez, connectez, r√©ussissez</h1>
      <nav class="links" aria-label="Navigation principale">
        <a href="/">Accueil</a>
        <a href="/connexion">Mon compte</a>
        <a href="#">Contact</a>
      </nav>
    </header>

    <img src="/images/fond.png" alt="couleur" />

    <main>
      <!-- BARRE DE RECHERCHE -->
      <div class="barre">
        <h5>Trouvez le job de vos r√™ves</h5>
        <div class="search">
          <form action="/jobs" method="get">
            <input
              name="q"
              placeholder="Intitul√© du poste"
              value="<%= typeof query !== 'undefined' ? query : '' %>"
            />
            <input name="location" placeholder="Localisation" />
            <button class="btnrechercher" type="submit">Rechercher</button>
          </form>
        </div>
      </div>

      <!-- SECTION OFFRES D‚ÄôEMPLOI -->
      <section class="annonces">
        <h2 class="annonces__title">Offres d‚Äôemploi</h2>

        <div class="annonces__grid">
          <% if (jobs && jobs.length > 0) { %>
            <% jobs.forEach(job => { %>
              <article class="card">
                <div class="card__body">
                  <h3 class="card__title"><%= job.company_name %></h3>
                  <p class="card__desc"><%= job.title %></p>
                  <p class="card__meta">üìç <%= job.location %></p>

                  <div class="card__more">
                    <%= job.description ? job.description.substring(0, 200) + '...' : 'Aucune description disponible.' %>
                  </div>

                  <a href="/jobs/details/<%= job.id %>" class="btn-ghost">En savoir plus</a>
                </div>
              </article>
            <% }) %>
          <% } else { %>
            <p>Aucune offre trouv√©e pour le moment.</p>
          <% } %>
        </div>
      </section>
    </main>

    <!-- FOOTER -->
    <footer class="footer">
      <div class="footer-grid">
        <div class="footer-col">
          <h3>√Ä propos</h3>
          <ul>
            <li><a href="#">Qui sommes-nous</a></li>
            <li><a href="#">Notre mission</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h3>Aide</h3>
          <ul>
            <li><a href="#">FAQ</a></li>
            <li><a href="#">Support</a></li>
          </ul>
        </div>
        <div class="footer-col">
          <h3>L√©gal</h3>
          <ul>
            <li><a href="#">Mentions l√©gales</a></li>
            <li><a href="#">Politique de confidentialit√©</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        ¬© <span id="year"></span> Ruca ‚Äî Tous droits r√©serv√©s
      </div>
    </footer>

    <script>
      // Toggle "En savoir plus"
      document.addEventListener("click", (e) => {
        const btn = e.target.closest(".btn-ghost");
        if (!btn) return;
        const card = btn.closest(".card");
        const open = !card.classList.contains("card--open");
        card.classList.toggle("card--open", open);
        btn.textContent = open ? "R√©duire" : "En savoir plus";
      });

      // Ann√©e dynamique
      document.getElementById("year").textContent = new Date().getFullYear();
    </script>

    <%- include('../partials/footer') %>
  </body>
</html>
